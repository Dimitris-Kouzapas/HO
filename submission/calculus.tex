\section{The Full Higher-Order Session $\pi$-Calculus}

We present the syntax and operational semantics for the
{\em Full Higher-Order Session $\pi$-calculus} or $\HOp$.
$\HOp$ is a simpler version of the higher-order calculus developed
in~\cite{tlca07}, that name and process abstraction application, as
well as implicit application of abstractions. We believe that
the higher-order semantics of the calculus is small and yet expressive
enough to capture in a simple way the principles of
session types.

\subsection{$\HOp$ Syntax}

The syntax for $\HOp$ processes is given in Figure~\ref{fig:syntax}.
We assume a set of names $S$ that range over $s, s_1, \dots$
and a dual set of $S$, $\dual{S}$ that ranges over $\dual{s}, \dual{s_1}, \dots$.
Intuitively, $s$ and $\dual{s}$ are dual \emph{endpoints}.
Both sets $S$ and $\dual{S}$ constitute the set of names $N$.
Name variables $x, y, z, \dots$ are taken from set $\mathsf{Var}$ and
process variable $X, Y, Z, \dots$ from set $\mathsf{PVar}$. 
Set $\mathsf{RVar}$ is the set of recursive 
variables that range over $\rvar{X}, \rvar{Y}, \dots$.
Abstractions, written $\abs{x}{P}$, are processes $P$ with a bound parameter $x$;
the set of all abstractions is denoted $\mathsf{Abs}$.
We denote either names or name variables with $k, k_1, \dots$.
We write $V, V', \ldots$ to denote name variables, process variables, recursive variables, or abstractions.
Intuitively, these are transmittable \emph{values}.
Note that set $N$ includes session and shared names.
We sometimes denote shared names with $a,b, c, \dots$, although $a, b, c, \dots \in S$.

Processes include the standard $\pi$-calculus prefixes for sending and receiving names.
Prefix $\bout{k}{k'} P$ denotes the sending of name $k$ over channel $k$ and then
continuing as $P$ whereas prefix $\binp{k}{x} P$ denotes the reception of a value
on channel $k$ over variable $x$ and then continue as $P$. Recursion is expressed
on the primitive recursor $\recp{X}{P}$ that binds the recursive variable/process
$\rvar{X}$ in the structure of $P$.

Higher-order syntax is composed by the sending prefix $\bout{k}{\abs{x}{Q}} P$ that
denotes the sending of abstraction $\abs{x}{Q}$ over channel $k$ and then continuing
as $P$. On the receiving side prefix $\binp{k}{X} P$ denotes the reception of an abstraction
on channel $k$ and over the process variable $\X$. Process $\appl{X}{k}$ is the application
process which is used to bind channel $k$ on the process substituting process variable $\X$.

We assume the standard session syntax for selection and branching. Process
$\bsel{k}{l} P$ selects label $l$ on channel $k$ and then behaves as $P$. 
Given $i \in I$, 
process 
$\bbra{k}{l_i:P_i}_{i \in I}$ offers a choice on labels $l_i$ with
corresponding continuation $P_i$.
The calculus is completed with the standard constructs for 
inaction $\inact$, 
parallel composition $P_1 \Par P_2$, and 
name restriction $\news{s} P$, which simultaneously binds endpoints $s$ and $\dual{s}$ in $P$.

A well-formed process relies on assumptions for guarded recursive processes.
A process is called a \emph{program} if it contains 
no free recursion variables nor free name/process variables.

\input{figures/fig-syntax}

Two significant sub-calculi of $\HOp$ will form the basis of our study.
The first sub-calculus involves name-passing but no process-passing constructs; it is 
defined by lines 1 and 3 of the syntax in Figure~\ref{fig:syntax}.
This is essentially a standard session $\pi$-calculus 
or $\sesp$ as defined in the bibliography~\cite{}.
The second sub-calculus features abstraction passing and application but no name-passing; 
it is defined by lines 2 and 3 of the same syntax. This language 
calculus is called the higher-order session calculus or $\HO$.


\subsection{Operational Semantics}

\paragraph{Structural Congruence}

We define structural congruence as the least congruence that satisfies the commutative monoid $(\Par, \inact)$
and the rules:

\begin{tabular}{c}
%	P \Par \inact \scong P \qquad P_1 \Par P_2 \scong P_2 \Par P_1 \qquad P_1 \Par (P_2 \Par P_3)
%	\qquad (P_1 \Par P_2) \Par P_3 \qquad
	$\news{s} \inact \scong \inact \quad
	s \notin \fn{P_1}$ implies $P_1 \Par \news{s} P_2 \scong \news{s}(P_1 \Par P_2)
	\quad \rec{X}{P} \scong P\subst{\rec{X}{P}}{\rvar{X}}$
\end{tabular}


We define the reduction semantics in Figure~\ref{fig:reduction}.
Figure~\ref{fig:reduction} first describes the process variable
substitution through the semantics
of name substitution. Substitution of application process $\appl{X}{k}$
over abstraction $\abs{x} Q$ substitutes free variable
$x$ in $Q$ with $k$ and replaces $X$ with the resulting process.
There is no effect on variable substitution for the inactive process.
In all the other cases process variable substitution is homorphic 
on the structure of the process.

\input{figures/fig-reduction}

There are three communication rules for the $\HOp$. The name passing
rule, $\orule{NPass}$ where a send prefix on channel $s$ sends
channel $s'$ to be received by parallel receive prefixed process
on the dual endpoint $\dual{s}$. After the reduction the continuation of the 
latter process substitutes $s'$ on the receive prefix object $x$.
The second communication axiom, $\orule{APass}$, describes
abstraction passing. An abstraction is sent on a send prefixed process
over channel $s$ and it is being received by a parallel $\dual{s}$-received
prefixed process. The latter process follows a process variable
substitution.
The third axiom is the standard select/branch action where
a process select label $l_k, k \in I$ on channel $s$ over a set of
labels $\set{l_i}_{i \in I}$ that are offered from a parallel process
on the dual session endpoint $\dual{s}$. The continuation of the latter
process is the corresponding process $P_k$.
The last three rules are congruence rules that preserve reduction
on the parallel, rule $\orule{Par}$ and name restriction, rule $\orule{Ses}$,
operators as well as reduction is closed under structural congruence, rule $\orule{Cong}$.



