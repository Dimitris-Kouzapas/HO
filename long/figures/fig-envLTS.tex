\begin{figure}[t]
	\[
%	\footnotesize
	\begin{array}{c}
		\eltsrule{SOut}~~\tree{
			\begin{array}{c}
				\dual{s} \notin \dom{\Delta}
				\qquad 
				\Gamma \cat \Gamma'; \Lambda'; \Delta_1 \cat \Delta_2 \proves V \hastype U
				\qquad
				\tilde{m} = m_1 \dots m_n
				\\
				\Gamma'; \es; \Delta_2 \proves m_1 \dots m_n \hastype U_1
				\qquad
				\Gamma'; \es; \Delta_3 \proves \dual{m}_1 \dots \dual{m}_n \hastype U_2
				\qquad
				\Lambda' \subseteq \Lambda
				\qquad
				\Delta_1 \subseteq (\Delta \cat s: S)
			\end{array}
		}{
			(\Gamma; \Lambda; \Delta \cat s: \btout{U} S) \by{\news{\tilde{m}} \bactout{s}{V}} (\Gamma \cat \Gamma'; \Lambda\backslash\Lambda';
			(\Delta \cat s: S \cat \Delta_3) \backslash (\Delta_1 \cat \Delta_2))
		}
		\\[8mm]

		\eltsrule{ShOut}~~\tree{
			\begin{array}{c}
				\Gamma \cat \Gamma' \cat a: \chtype{U}; \Lambda'; \Delta_1 \cat \Delta_2 \proves V \hastype U
				\qquad
				\tilde{m} = m_1 \dots m_n
				\\
				\Gamma'; \es; \Delta_2 \proves m_1 \dots m_n \hastype U_1
				\qquad
				\Gamma'; \es; \Delta_3 \proves \dual{m}_1 \dots \dual{m}_n \hastype U_2
				\qquad
				\Lambda' \subseteq \Lambda
				\qquad
				\Delta_1 \subseteq \Delta
			\end{array}
		}{
			(\Gamma \cat a: \chtype{U} ; \Lambda; \Delta) \by{\news{\tilde{m}} \bactout{a}{V}} (\Gamma \cat \Gamma' \cat a: \chtype{U}; \Lambda\backslash\Lambda';
			(\Delta \cat \Delta_3) \backslash (\Delta_1 \cat \Delta_2))
		}
		\\[8mm]



\begin{comment}
		\eltsrule{SOut}~~\tree{
			\begin{array}{c}
				\dual{s} \notin \dom{\Delta}
				\qquad 
				\Gamma \cat \Gamma'; \Lambda'; \Delta_1 \cat \Delta_2 \proves V \hastype U
				\qquad
				\Lambda' \subseteq \Lambda
				\qquad
				\Delta_1 \subseteq \Delta\\
				a \in \tilde{m} \Leftrightarrow a: \chtype{U'} \in \Gamma' \quad
				s_i \in \tilde{m} \Leftrightarrow (s_i: S_i \in \Delta_2 \wedge \dual{s_i}: S'_i \in \Delta_3 \wedge S_i \dualof S'_i)
			\end{array}
		}{
			(\Gamma; \Lambda; \Delta \cat s: \btout{U} S) \by{\news{\tilde{m}} \bactout{s}{V}} (\Gamma \cat \Gamma'; \Lambda\backslash\Lambda'; (\Delta\backslash\Delta_1) \cat \Delta_3 \cat s: S)			
		}
		\\[8mm]

		\eltsrule{ShOut}~~\tree{
			\begin{array}{c}
				\Gamma \cat \Gamma' \cat a: \chtype{U}; \Lambda'; \Delta_1 \cat \Delta_2 \proves V \hastype U
				\qquad
				\Lambda' \subseteq \Lambda
				\qquad
				\Delta_1 \subseteq \Delta\\
				b \in \tilde{m} \Leftrightarrow b: \chtype{U'} \in \Gamma \quad
				s \in \tilde{m} \Leftrightarrow (s_i: S_i \in \Delta_2 \wedge \dual{s_i}: S'_i \in \Delta_3 \wedge S_i \dualof S'_i)
			\end{array}
		}{
			(\Gamma\cat a: \chtype{U}; \Lambda; \Delta) \by{\news{\tilde{m}} \bactout{a}{V}} (\Gamma \cat \Gamma'\cat a: \chtype{U}; \Lambda\backslash\Lambda'; (\Delta\backslash\Delta_1) \cat \Delta_3)			
		}
		\\[8mm]
\end{comment}


		\eltsrule{SRecv}~~\tree{
			\dual{s} \notin \dom{\Delta} \quad \Gamma; \Lambda'; \Delta' \proves V \hastype U
		}{
			(\Gamma; \Lambda; \Delta \cat s: \btinp{U} S) \by{\bactinp{s}{V}} (\Gamma; \Lambda\cat\Lambda'; \Delta\cat\Delta' \cat s: S)
		}
		\\[8mm]

		\eltsrule{ShRecv}~~\tree{
			\Gamma; \es; \es \proves a \hastype \chtype{U}
			\quad
			\Gamma; \Lambda'; \Delta' \proves V \hastype U
		}{
			(\Gamma; \Lambda; \Delta) \by{\bactinp{a}{\tilde{V}}} (\Gamma; \Lambda\cat\Lambda'; \Delta\cat\Delta')
		}
		\\[8mm]

		\eltsrule{Sel}~~\tree{
			\dual{s} \notin \dom{\Delta} \quad j \in I
		}{
			(\Gamma; \Lambda; \Delta \cat s: \btsel{l_i: S_i}_{i \in I}) \by{\bactsel{s}{l_j}} (\Gamma; \Lambda; \Delta \cat s:S_j)
		}
		\qquad
		\eltsrule{Bra}~~\tree{
			\dual{s} \notin \dom{\Delta} \quad j \in I
		}{
			(\Gamma; \Lambda; \Delta \cat s: \btbra{l_i: T_i}_{i \in I}) \by{\bactbra{s}{l_j}} (\Gamma; \Lambda; \Delta \cat s:S_j)
		}
		\\[8mm]

		\eltsrule{Tau}~~\tree{
			\Delta_1 \red \Delta_2 \vee \Delta_1 = \Delta_2
		}{
			(\Gamma; \Lambda; \Delta_1) \by{\tau} (\Gamma; \Lambda; \Delta_2)
		}

		\vspace{12mm}\\


		\eltsrule{RRcv}~~\tree {
			(\Gamma_1; \Lambda_1; \Delta_1) \by{\bactinp{n}{V}} (\Gamma_2; \Lambda_2; \Delta_2)
			\quad
			\begin{array}{crcl}
				& (V & = & \abs{\tilde{x}}{\binp{t}{X} \appl{X}{\tilde{x}}} \wedge t \textrm{ fresh}) \\
				\vee & V &=& \abs{\tilde{x}}{\map{U}^{\tilde{x}}}  \vee V = \tilde{m}
			\end{array}
		}{
			(\Gamma_1; \Lambda_1; \Delta_1) \hby{\bactinp{n}{V}} (\Gamma_2; \Lambda_1; \Delta_2)
		}
		%\\[6mm]

\begin{comment}
		\eltsrule{Rule1}~~\tree{
			U = \lhot{\tilde{C}} \vee U = \shot{\tilde{C}}
			\quad
			(\Gamma_1; \Lambda_1; \Delta_1) \by{\bactinp{n}{\abs{\tilde{x}}{\map{U}^{\tilde{x}}}}} (\Gamma_2; \Lambda_2; \Delta_2)
		}{
			(\Gamma_1; \Lambda_1; \Delta_1) \hby{\bactinp{n}{\abs{\tilde{x}}{\map{U}^{\tilde{x}}}}} (\Gamma_2; \Lambda_1; \Delta_2)
		}
		\\[6mm]

		\eltsrule{Rule2}~~\tree{
			\dual{s}, \dual{t} \notin \dom{\Delta}
		}{
			(\Gamma; \Lambda; \Delta \cat s: \btinp{\lhot{\tilde{C}}} S) \hby{\bactinp{s}{\abs{\tilde{x}}{\binp{t}{X} \appl{X}{\tilde{x}}}}} (\Gamma; \Lambda; \Delta \cat s: S \cat t: \btinp{\lhot{\tilde{C}}} \tinact)
		}
		\\[6mm]

		\eltsrule{Rule3}~~\tree{
			\dual{t} \notin \dom{\Delta}
		}{
		(\Gamma \cat a: \chtype{\lhot{\tilde{C}}}; \Lambda; \Delta) \hby{\bactinp{a}{\abs{\tilde{x}}{\binp{t}{X} \appl{X}{\tilde{x}}}}} (\Gamma \cat a: \chtype{\lhot{\tilde{C}}}; \Lambda; \Delta \cat t: \btinp{\lhot{\tilde{C}}}
 \tinact)
		}
		\\[6mm]

		\eltsrule{Rule4}~~\tree{
			\dual{s} \notin \dom{\Delta} \quad t \notin \dom{\Gamma}
		}{
			(\Gamma; \Lambda; \Delta \cat s: \btinp{\shot{\tilde{C}}} S) \hby{\bactinp{s}{\abs{\tilde{x}}{\binp{t}{X} \appl{X}{\tilde{x}}}}} (\Gamma \cat t: \chtype{\lhot{\tilde{C}}}; \Lambda; \Delta \cat s: S)
		}
		\\[6mm]
		\eltsrule{Rule5}~~\tree{
			t \notin \dom{\Gamma}
		}{
			(\Gamma \cat a: \chtype{\shot{\tilde{C}}}; \Lambda; \Delta) \hby{\bactinp{a}{\abs{\tilde{x}}{\binp{t}{X} \appl{X}{\tilde{x}}}}} (\Gamma \cat a: \chtype{\shot{\tilde{C}}} \cat t: \chtype{\lhot{\tilde{C}}}; \Lambda; \Delta)
		}
		\\[6mm]
\end{comment}
	\end{array}
	\]
	\caption{Labelled Transition Semantics for Typed Environments \label{fig:envLTS}}
\end{figure}
