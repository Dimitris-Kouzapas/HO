% !TEX root = main.tex
%\section{Example}

\noi 
Following up the claim made in \S\,\ref{sec:relwork}, 
we contrast our approach with that in~\cite{JeffreyR05} in a concrete, representative example.
\begin{example}

	Consider process
	$$\Gamma; \es; \Delta \cat n: \btout{U} \tinact \proves \bout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact \hastype \Proc$$
	with $U = \shot{(\shot{(\shot{(\btout{S} \tinact)})})}$. 
	We describe the transitions required to check the bisimilarity
	of this process with itself. 
	In our framework, first we have a typed transition
	$$
	\Gamma; \es; \Delta \cat n: \btout{U} \tinact \proves \bout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact \by{\bactout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}}}\Gamma; \es; \Delta \proves \inact
	$$
	In the framework of~\cite{JeffreyR05} a similar (but untyped) output transition takes place.
    In \figref{f:comparison} we compare the closures obtained by the definition of bisimilarity in our approach (lines (1) to (5)) and in~\cite{JeffreyR05} (lines (6) to (10)).
    In the upper part, we let 
    \begin{eqnarray*}
    V & = & \abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)} \\
	\mapchar{\btinp{U} \inact}{s} & = & \binp{s}{x} \appl{x}{(\abs{y}{(\appl{y}{a}))}}\qquad \text{for some fresh $a$}
	\end{eqnarray*}
	Then we have one visible input transition (line (1)), followed by four internal transitions; no replicated processes are needed.
	The approach of~\cite{JeffreyR05} uses 
	the same number of transitions (five), but more visible transitions are required
	(three, in lines (6), (8), and (9)) and at the end, two replicated processes remain.
	This is how linearity information in session types allows us to have more economical closures.
	Note that $\tau_l$ and $\tau_k$ in lines (6) and (8) denote triggered processes on names $l$ and $k$.
	
	
%This simple example shows how both approaches feature the same number of (typed) transitions.
%It is interesting to see how our approach based on refined LTS and characteristic bisimilarity requires less observable actions than that in~\cite{JeffreyR05}.
%Also, as we are able to distinguish between linear and shared names, we require less replicated processes than in~\cite{JeffreyR05}.
	
	
%
%	\begin{eqnarray*}
%		\mapchar{\btinp{U} \inact}{s}\\
%		= && \binp{s}{x} \mapchar{\shot{(\shot{(\shot{(\btout{S} \tinact)})})}}{x}\\
%		= && \binp{s}{x} \appl{x}{\omapchar{\shot{(\shot{(\btout{S} \tinact)})}}}\\
%		= && \binp{s}{x} \appl{x}{(\abs{y}{\mapchar{\shot{(\btout{S} \tinact)}}{y}})}\\
%		= && \binp{s}{x} \appl{x}{(\abs{y}{\appl{y}{\omapchar{\btout{S} \tinact}})}}\\
%		= && \binp{s}{x} \appl{x}{(\abs{y}{\appl{y}{a})}}\\
%	\end{eqnarray*}
%
%	The characteristic process of
%	the type $\shot{(\shot{(\shot{(\btout{S} \tinact)})})}$ is

\begin{figure}
\begin{tabular}{|c|}
\hline 
	\begin{tabular}{rcl}
%		(1)& & $\Gamma; \es; \Delta \cat n: \btout{U} \tinact \proves \bout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact$ \\
%		&$\by{\bactout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}}}$& $\Gamma; \es; \Delta \proves \inact$\\
         &    &   $\ftrigger{t}{V}{U}$  \\
		   &  $=$ & $\Gamma; \es; \Delta \proves \binp{t}{z} \newsp{s}{\mapchar{\btinp{U} \inact}{s} \Par \bout{\dual{s}}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact}$\\
		&  $=$& $\Gamma; \es; \Delta \proves \binp{t}{z} \newsp{s}{\binp{s}{x} \appl{x}{(\abs{y}{(\appl{y}{a}))}} \Par \bout{\dual{s}}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact}$\\
		(1)   &$\by{\bactinp{t}{b}}$& $\Gamma; \es; \Delta \proves \newsp{s}{\binp{s}{x} \appl{x}{(\abs{y}{(\appl{y}{a}))}} \Par \bout{\dual{s}}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact}$\\
		(2)  &$\by{\tau}$& $\Gamma; \es; \Delta \proves \appl{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m} \inact})}}{(\abs{y}{(\appl{y}{a}))}}$\\
		(3)  &$\by{\btau}$& $\Gamma; \es; \Delta \proves \appl{(\abs{y}{(\appl{y}{a})})}{(\abs{y}{\bout{y}{m} \inact})} $\\
		(4)   &$\by{\btau}$& $\Gamma; \es; \Delta \proves \appl{(\abs{y}{\bout{y}{m} \inact})}{a}$\\
		(5)   &$\by{\btau}$& $\Gamma; \es; \Delta \proves \bout{a}{m} \inact$ \vspace{1mm}
	\end{tabular} 
	\\ \hline
		\begin{tabular}{rrl}
%		(1)& & $\Gamma; \es; \Delta \cat n: \btout{U} \tinact \proves \bout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact$ \\
%		&$\by{\bactout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}}}$& $\Gamma; \es; \Delta \proves \inact$\\
		 & & $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) $\\
		(6) &$\by{\bactinp{t}{\tau_l}}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \appl{(\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)})}{\tau_l}$\\
		(7) &$\by{\btau}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \appl{\tau_l}{(\abs{y}{\bout{y}{m}} \inact)}$\\
		(8) &$\by{\news{k} \bactout{l}{\tau_k}}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \repl{} \binp{k}{y} \bout{y}{m} \inact $\\
		(9) &$\by{\bactinp{k}{a}}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \repl{} \binp{k}{y} \bout{y}{m} \inact \Par \appl{(\abs{y}{\bout{y}{m} \inact})}{a}$\\
		(10) &$\by{\btau}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \repl{} \binp{k}{y} \bout{y}{m} \inact \Par \bout{a}{m} \inact$
	\end{tabular}
	 \\ \hline
	\end{tabular}
\caption{Comparison between our approach (upper part) and Jeffrey and Rathke's~\cite{JeffreyR05} (lower part).\label{f:comparison} }
\end{figure}

%\noi In our approach, we would have the following typed transitions:
%
%	\begin{tabular}{rrl}
%		(1)& & $\Gamma; \es; \Delta \cat n: \btout{U} \tinact \proves \bout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact$ \\
%		&$\by{\bactout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}}}$& $\Gamma; \es; \Delta \proves \inact$\\
%		(2) & & $\Gamma; \es; \Delta \proves \binp{t}{z} \newsp{s}{\mapchar{\btinp{U} \inact}{s} \Par \bout{\dual{s}}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact}$\\
%		&$=$& $\Gamma; \es; \Delta \proves \binp{t}{z} \newsp{s}{\binp{s}{x} \appl{x}{(\abs{y}{\appl{y}{a})}} \Par \bout{\dual{s}}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact}$\\
%		(3) &$\by{\bactinp{t}{b}}$& $\Gamma; \es; \Delta \proves \newsp{s}{\binp{s}{x} \appl{x}{(\abs{y}{\appl{y}{a})}} \Par \bout{\dual{s}}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact}$\\
%		(4) &$\by{\tau}$& $\Gamma; \es; \Delta \proves \appl{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m} \inact})}}{(\abs{y}{\appl{y}{a})}}$\\
%		(5) &$\by{\tau}$& $\Gamma; \es; \Delta \proves \appl{(\abs{y}{\appl{y}{a}})}{(\abs{y}{\bout{y}{m} \inact})} $\\
%		(6) &$\by{\tau}$& $\Gamma; \es; \Delta \proves \appl{(\abs{y}{\bout{y}{m} \inact})}{a}$\\
%		(7) &$\by{\tau}$& $\Gamma; \es; \Delta \proves \bout{a}{m} \inact$
%	\end{tabular}
%
%\noi In the approach defined in~\cite{JeffreyR05} we would have:
%
%	\begin{tabular}{rrl}
%		(1)& & $\Gamma; \es; \Delta \cat n: \btout{U} \tinact \proves \bout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}} \inact$ \\
%		&$\by{\bactout{n}{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}}}$& $\Gamma; \es; \Delta \proves \inact$\\
%		(2) & & $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) $\\
%		(3) &$\by{\bactinp{t}{\tau_l}}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \appl{\abs{x}{\appl{x}(\abs{y}{\bout{y}{m}} \inact)}}{\tau_l}$\\
%		(4) &$\by{\tau}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \appl{\tau_l}{(\abs{y}{\bout{y}{m}} \inact)}$\\
%		(5) &$\by{\bactout{l}{\tau_k}}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \repl{} \binp{k}{y} \bout{y}{m} \inact $\\
%		(6) &$\by{\bactinp{k}{a}}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \repl{} \binp{k}{y} \bout{y}{m} \inact \Par \appl{\abs{y}{\bout{y}{m} \inact}}{a}$\\
%		(7) &$\by{\tau}$& $\Gamma; \es; \Delta \proves \repl{} \binp{t}{x} \appl{x}(\abs{y}{\bout{y}{m}} \inact) \Par \repl{} \binp{k}{y} \bout{y}{m} \inact \Par \bout{a}{m} \inact$
%	\end{tabular}
	
 

%	Comparing
%	\begin{itemize}
%		\item	Same number of transitions.
%		\item	J \& R more observable actions.
%		\item	J \& R replicated processes.
%	\end{itemize}

\end{example}


